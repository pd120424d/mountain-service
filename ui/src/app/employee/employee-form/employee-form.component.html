<form [formGroup]="employeeForm" (ngSubmit)="onSubmit()">
  <label for="username">{{ 'EMPLOYEE_FORM.USERNAME' | translate }}:</label>
  <input id="username" formControlName="username" type="text">

  <!-- Password fields are only shown if not in edit mode -->
  <div *ngIf="!isEditMode">
    <label for="password">{{ 'EMPLOYEE_FORM.PASSWORD' | translate }}:</label>
    <div class="password-wrapper">
      <input id="password" formControlName="password" [type]="showPassword ? 'text' : 'password'">
      <button type="button" class="eye-toggle" (click)="showPassword = !showPassword" aria-label="Toggle password visibility">
        <i class="fas" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
      </button>
    </div>
    <div class="error-message" *ngIf="employeeForm.get('password')?.invalid && (employeeForm.get('password')?.dirty || employeeForm.get('password')?.touched)">
      {{ getPasswordErrorKey() | translate }}
    </div>

    <label for="confirmPassword">{{ 'EMPLOYEE_FORM.CONFIRM_PASSWORD' | translate }}:</label>
    <div class="password-wrapper">
      <input id="confirmPassword" formControlName="confirmPassword" [type]="showConfirmPassword ? 'text' : 'password'">
      <button type="button" class="eye-toggle" (click)="showConfirmPassword = !showConfirmPassword" aria-label="Toggle confirm password visibility">
        <i class="fas" [ngClass]="showConfirmPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
      </button>
    </div>
    <div class="error-message" *ngIf="confirmPasswordMismatch && (employeeForm.get('confirmPassword')?.dirty || employeeForm.get('confirmPassword')?.touched)">
      {{ 'EMPLOYEE_FORM.CONFIRM_PASSWORD_MISMATCH' | translate }}
    </div>
  </div>

  <label for="firstName">{{ 'EMPLOYEE_FORM.FIRST_NAME' | translate }}:</label>
  <input id="firstName" formControlName="firstName" type="text">

  <label for="lastName">{{ 'EMPLOYEE_FORM.LAST_NAME' | translate }}:</label>
  <input id="lastName" formControlName="lastName" type="text">

  <label for="gender">{{ 'EMPLOYEE_FORM.GENDER' | translate }}:</label>
  <select id="gender" formControlName="gender">
    <option value="M">{{ 'EMPLOYEE_FORM.GENDER_OPTIONS.MALE' | translate }}</option>
    <option value="F">{{ 'EMPLOYEE_FORM.GENDER_OPTIONS.FEMALE' | translate }}</option>
  </select>

  <label for="phoneNumber">{{ 'EMPLOYEE_FORM.PHONE' | translate }}:</label>
  <input id="phoneNumber" formControlName="phoneNumber" type="text">

  <label for="email">{{ 'EMPLOYEE_FORM.EMAIL' | translate }}:</label>
  <input id="email" formControlName="email" type="email" [disabled]="isEditMode">

  <ng-container *ngIf="isEditMode">
    <label for="profilePicture">{{ 'EMPLOYEE_FORM.PROFILE_PICTURE' | translate }}:</label>
    <app-image-upload
      [employeeId]="employeeId"
      [cacheKey]="'employee-form-' + (employeeId || 'new')"
      [initialImageUrl]="currentProfilePictureUrl"
      (imageSelected)="onImageSelected($event)"
      (imageRemoved)="onImageRemoved()">
    </app-image-upload>
  </ng-container>

  <label for="profileType">{{ 'EMPLOYEE_FORM.PROFILE_TYPE' | translate }}:</label>
  <select id="profileType" formControlName="profileType">
    <option value="Medic">{{ 'EMPLOYEE_FORM.PROFILE_OPTIONS.MEDIC' | translate }}</option>
    <option value="Technical">{{ 'EMPLOYEE_FORM.PROFILE_OPTIONS.TECHNICAL' | translate }}</option>
  </select>

  <div class="form-actions">
    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="isSubmitting || !employeeForm.valid">
      <span *ngIf="isSubmitting">{{ 'EMPLOYEE_FORM.SUBMITTING' | translate }}</span>
      <span *ngIf="!isSubmitting">{{ 'EMPLOYEE_FORM.SAVE' | translate }}</span>
    </button>
    <button
      type="button"
      class="btn btn-secondary"
      [disabled]="isSubmitting"
      (click)="cancel()">
      {{ 'EMPLOYEE_FORM.CANCEL' | translate }}
    </button>
  </div>
</form>

<!-- Global spinner for loading states -->
<ngx-spinner></ngx-spinner>
